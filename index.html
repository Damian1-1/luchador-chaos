// Ta funkcja zbiera logi i zapisuje je w formie tekstu.
function collectGameLog() {
    let logText = "--- Podsumowanie rozgrywki ---\n\n";
    gameLog.forEach(log => {
        let entry = `Tura ${log.turn}: `;

        if (log.type === 'game_start') {
            entry += `Gra rozpoczęta! Data: ${log.timestamp.toLocaleTimeString()}.`;
        } else if (log.type === 'player_setup') {
            entry += `Zawodnicy: ${log.players.map(p => p.name).join(', ')}.`;
        } else if (log.type === 'player_action') {
            entry += `${log.player} używa karty ${log.card_played}.`;
        } else if (log.type === 'push_resolved') {
            entry += `${log.pusher} wypycha ${log.pushed} o ${log.distance} pól!`;
        } else if (log.type === 'elimination') {
            entry += `${log.player} został wyeliminowany!`;
        } else if (log.type === 'game_end') {
            entry += `Koniec gry! Zwycięzca: ${log.winner || 'brak'}.`;
        } else if (log.type === 'enthusiasm_change') {
            entry += `Entuzjazm publiki zmienia się o ${log.change} (nowy poziom: ${log.new_value}).`;
        }

        logText += `${entry}\n`;
    });
    return logText;
}

// Ta funkcja generuje i pobiera plik .txt.
function downloadLogFile() {
    const logContent = collectGameLog();
    const blob = new Blob([logContent], { type: 'text/plain;charset=utf-8' });
    const link = document.createElement('a');
    link.href = URL.createObjectURL(blob);
    link.download = 'log_rozgrywki.txt';
    link.style.display = 'none';
    document.body.appendChild(link);
    link.click();
    document.body.removeChild(link);
}
